# Doxygen + Quarto Documentation Integration

This document explains how the Doxygen API documentation is integrated with the Quarto documentation website.

## Overview

The WhiskerToolbox documentation combines:
- **Quarto documentation** (`.qmd` files): User guides, tutorials, and concept explanations
- **Doxygen API reference**: Automatically generated from C++ source code comments

## Setup

### Prerequisites

1. **Doxygen** (version 1.9.8 or later):
   ```bash
   # Ubuntu/Debian
   sudo apt-get install doxygen graphviz
   
   # macOS
   brew install doxygen graphviz
   
   # Windows
   # Download from https://www.doxygen.nl/download.html
   ```

2. **Quarto** (for building the documentation website):
   - Download from https://quarto.org/docs/get-started/

## Generating API Documentation

To generate or update the Doxygen API documentation:

```bash
cd /path/to/WhiskerToolbox
doxygen Doxyfile
```

This will:
- Scan all source files in the `src/` directory
- Extract Doxygen comments
- Generate HTML documentation in `docs/api/html/`

## Building the Complete Documentation Site

To build the complete Quarto website including the API reference:

```bash
cd docs
quarto render
```

The rendered website will include:
- All Quarto pages
- The API reference page at `api_reference.html`
- The Doxygen documentation accessible through the API reference page

## Documentation Structure

```
docs/
├── _quarto.yml              # Quarto configuration
├── api_reference.qmd        # API reference landing page
├── api/                     # Generated by Doxygen (gitignored)
│   └── html/               # Doxygen HTML output
│       └── index.html      # Doxygen main page
├── developer/              # Developer documentation
├── user_guide/             # User documentation
└── ...
```

## How It Works

1. **Doxygen Configuration** (`Doxyfile`):
   - `PROJECT_NAME`: Set to "WhiskerToolbox"
   - `INPUT`: Points to `src/` directory
   - `OUTPUT_DIRECTORY`: Set to `docs/api`
   - `RECURSIVE`: Enabled to scan all subdirectories
   - `EXTRACT_ALL`: Enabled to document all entities
   - `GENERATE_TREEVIEW`: Enabled for better navigation

2. **Quarto Integration** (`docs/_quarto.yml`):
   - Added "API Reference" to the navbar under "Reference Guides"
   - Added to the Developer Documentation sidebar
   - Links to `api_reference.qmd`

3. **API Reference Page** (`api_reference.qmd`):
   - Provides an overview of the API documentation
   - Embeds the Doxygen documentation using an iframe
   - Includes a link to open the full documentation in a new tab

## Continuous Integration

To automate documentation generation in CI/CD:

1. Install Doxygen in your CI environment
2. Run `doxygen Doxyfile` before building the Quarto site
3. Deploy the complete `docs/` directory

Example GitHub Actions workflow snippet:

```yaml
- name: Install Doxygen
  run: sudo apt-get install -y doxygen graphviz

- name: Generate API Documentation
  run: doxygen Doxyfile

- name: Build Quarto Site
  run: |
    cd docs
    quarto render
```

## Updating API Documentation

Whenever you:
- Add new classes or functions
- Update Doxygen comments
- Modify the public API

Simply regenerate the documentation:

```bash
doxygen Doxyfile
```

The Quarto site will automatically include the updated API documentation.

## Customizing Doxygen Output

To customize the Doxygen documentation appearance or behavior, edit the `Doxyfile` configuration. Some useful settings:

- `PROJECT_BRIEF`: Short project description
- `GENERATE_TREEVIEW`: Enable/disable sidebar navigation
- `HTML_EXTRA_STYLESHEET`: Add custom CSS
- `HTML_HEADER/FOOTER`: Custom header/footer
- `USE_MDFILE_AS_MAINPAGE`: Use a markdown file as the main page

## Troubleshooting

### API documentation not showing up

1. Verify Doxygen generated files:
   ```bash
   ls docs/api/html/index.html
   ```

2. Check Doxyfile OUTPUT_DIRECTORY setting matches `docs/api`

3. Ensure `docs/api/` is not in `.gitignore` if you want to commit it (currently it is gitignored for local development)

### Iframe not displaying

Some browsers block iframes for security. The API reference page also includes a direct link as a fallback.

## Further Reading

- [Doxygen Manual](https://www.doxygen.nl/manual/)
- [Quarto Documentation](https://quarto.org/docs/guide/)
- [Doxygen Commenting Style](https://www.doxygen.nl/manual/docblocks.html)
